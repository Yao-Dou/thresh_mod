import{_ as u,j as p,a as b}from"./js-yaml-0380fc99.js";import{o as n,c as l,a as s,t as k,b as g,d as y,h as D,e as w,F as L,r as S,f as I,n as z,g as O,i as P,j as T,k as R}from"./index-a018e75f.js";const C={class:"landing-box"},F={class:"container landing-container"},V=s("h4",null,"Annotating with",-1),N={class:"flex justify-center"},U=s("label",{for:"assetsFieldHandle",class:"block cursor-pointer"},[s("div",null,[y(" Drag & drop, or "),s("span",{class:"underline"},"click here"),y(" to add an annotation file ")])],-1),E={key:0,class:"separator"},B=s("span",null,"or",-1),W=[B],A={key:1,class:"option-buttons"},H=["href"],Y=s("button",{class:"pa2 ph3 br-pill-ns ba bw1 grow hit-instructions-btn"},"See Tutorial",-1),J=[Y],q=s("button",{class:"pa2 ph3 br-pill-ns ba bw1 grow hit-instructions-btn"},"View Example Data",-1),G=[q],K=["href"],M=s("button",{class:"pa2 ph3 br-pill-ns ba bw1 grow hit-instructions-btn"},"Customize this Template",-1),Q=[M],X=["href"],Z=s("button",{class:"pa2 ph3 br-pill-ns ba bw1 grow hit-instructions-btn"},"View Paper",-1),x=[Z],ee={data(){return{filelist:[],config:{}}},props:["consumed_config","set_data","set_config","customize_template_link"],watch:{consumed_config(){this.consume_config()}},methods:{consume_config(){this.consumed_config.hasOwnProperty("consumed_config")?this.config=u.cloneDeep(this.consumed_config.consumed_config):this.consumed_config.hasOwnProperty("config")?this.config=u.cloneDeep(this.consumed_config.config):this.config=u.cloneDeep(this.consumed_config),this.config.template_label&&$("title").text(this.config.template_label)},async handle_drag_drop(t){var a;let e=await D(t);if(this.config.template_name=="serverless"){let i=(a=e.find(r=>r.hasOwnProperty("_thresh_template")))==null?void 0:a._thresh_template;i=p.load(i),this.set_config(i),e=e.filter(r=>!("_thresh_template"in r))}this.set_data(e)},remove(t){this.filelist.splice(t,1)},dragover(t){t.preDefault(),t.currentTarget.classList.contains("bg-green-300")||(t.currentTarget.classList.remove("bg-gray-100"),t.currentTarget.classList.add("bg-green-300"))},dragleave(t){t.currentTarget.classList.add("bg-gray-100"),t.currentTarget.classList.remove("bg-green-300")},async drop(t){t.preDefault(),await handle_drag_drop(t),t.currentTarget.classList.add("bg-gray-100"),t.currentTarget.classList.remove("bg-green-300")},get_example_data(){let t;if(this.customize_template_link.includes("http"))this.config.default_data_link?t=this.config.default_data_link:t="data/demo/start.json";else{let e=this.config.template_name;e=e.replace("demo_","demo/"),t=`data/${e}.json`}w(t).then(e=>{this.set_data(e)})}},created(){this.consume_config()},computed:{template_link(){return`/?t=${this.customize_template_link}`}}},te=Object.assign(ee,{__name:"Landing",setup(t){return(e,a)=>(n(),l("main",C,[s("div",F,[V,s("h2",null,k(e.config.template_label),1),s("h3",null,k(e.config.template_description),1),s("div",N,[s("div",{class:"ba b--dashed bw2 file-box",onDragover:a[1]||(a[1]=(...i)=>e.dragover&&e.dragover(...i)),onDragleave:a[2]||(a[2]=(...i)=>e.dragleave&&e.dragleave(...i)),onDrop:a[3]||(a[3]=(...i)=>e.drop&&e.drop(...i))},[s("input",{type:"file",multiple:"",name:"fields[assetsFieldHandle][]",id:"assetsFieldHandle",class:"file-input-field",onChange:a[0]||(a[0]=(...i)=>e.handle_drag_drop&&e.handle_drag_drop(...i)),ref:"file",accept:".json"},null,544),U],32)]),e.config.template_name!="serverless"?(n(),l("div",E,W)):g("",!0),e.config.template_name!="serverless"?(n(),l("div",A,[e.config.tutorial_link?(n(),l("a",{key:0,href:e.config.tutorial_link},J,8,H)):g("",!0),s("a",{onClick:a[4]||(a[4]=(...i)=>e.get_example_data&&e.get_example_data(...i))},G),t.customize_template_link?(n(),l("a",{key:1,href:e.template_link},Q,8,K)):g("",!0),e.config.paper_link?(n(),l("a",{key:2,href:e.config.paper_link,target:"_blank"},x,8,X)):g("",!0)])):g("",!0)])]))}});const ae={key:0},ie={key:0,class:"adjudication-container mh4"},se={key:1,class:"mh4"},ne={key:1},oe={key:2},le=s("div",{class:"spinner-container"},[s("div",{class:"spinner"})],-1),re=[le],ce={data(){return{data:null,consumed_config:null,set_data:this.set_data,set_config:this.set_config,customize_template_link:null,is_fetching:!0,configInjection:null}},props:["template_path","serverless","injection"],methods:{set_data(t){this.data=t},set_config(t){this.consumed_config=t},highlight_container(t){if(this.consumed_config.highlight_first_interface&&t==1)return"adjudication-container-highlight"},async load_language(t){const a=`lang/${t.language||"en"}.yml`;let i=await P(a).then(r=>p.load(r));return t.interface_text=Object.assign({},i,t.interface_text),t},async load_config(t){let e=p.load(t);e=await this.load_language(e);var i=new URLSearchParams(window.location.search).get("PROLIFIC_PID");i&&(e.crowdsource="prolific"),this.set_config(e)},async load_data(t=null){const e=new URLSearchParams(window.location.search);var a=e.get("d"),i=e.get("gh"),r=e.get("hf"),d=e.get("cid");if((window.location.pathname.endsWith("/legal")||window.location.pathname.endsWith("/legal/"))&&!a){const c=["45696","46094","46210","46234","46349"];let o=d||"46210";d&&!c.includes(d)&&(console.warn(`Invalid case ID: ${d}. Using default case 46210.`),o="46210"),a=`data/legal_extract_checklist_paragraph/legal_cases_reference/${o}.json`}var h=e.get("PROLIFIC_PID"),f=e.get("STUDY_ID"),m=e.get("SESSION_ID");if(a){let c=a;i?c=`https://raw.githubusercontent.com/${a}`:r&&(c=`https://huggingface.co/datasets/${a.replace("main","resolve/main")}`),await w(c).then(o=>{if(h)for(let _ of o)_.metadata||(_.metadata={}),_.metadata.PROLIFIC_PID=h,_.metadata.STUDY_ID=f,_.metadata.SESSION_ID=m;this.consumed_config.adjudication&&(o=Array(this.consumed_config.adjudication).fill(o)),this.set_data(o)})}else if(this.consumed_config.adjudication){let c=Array(this.consumed_config.adjudication).fill(null);for(let o=1;o<this.consumed_config.adjudication+1;o++){var v=e.get(`d${o}`);v&&(c[o-1]={data:await w(v)})}this.set_data(c)}else this.set_data(t)}},created:async function(){let t;const e=new URLSearchParams(window.location.search);var a=e.get("i"),i=e.get("gh"),r=e.get("hf");const d=window.location.pathname.endsWith("/legal")||window.location.pathname.endsWith("/legal/");if(a?(t=a,this.customize_template_link=t):i?(t=`https://raw.githubusercontent.com/${i}`,this.customize_template_link=t):r?(t=`https://huggingface.co/datasets/${r.replace("main","resolve/main")}`,this.customize_template_link=t):d?(t="templates/legal_extract_checklist_paragraph/1.yml",this.customize_template_link="legal_extract_checklist_paragraph/1"):(t=`templates/${this.template_path}.yml`,this.customize_template_link=this.template_path),this.serverless&&(t="templates/serverless.yml"),this.injection){window.addEventListener("message",async f=>{await this.load_config(f.data.template);const m=await JSON.parse(f.data.data);await this.load_data(m),this.customize_template_link=null,this.is_fetching=!1});return}const h=await P(t);await this.load_config(h),await this.load_data(),this.is_fetching=!1}},ge=Object.assign(ce,{__name:"Viewer",setup(t){return(e,a)=>e.consumed_config!=null&&e.consumed_config!=null&&e.data!=null&&e.data!=null&&e.is_fetching==!1?(n(),l("main",ae,[e.consumed_config.adjudication?(n(),l("div",ie,[(n(!0),l(L,null,S(e.consumed_config.adjudication,i=>(n(),T(b,{key:i,class:R(e.highlight_container(i)),highlight:e.consumed_config.highlight_first_interface&&i==1,input_data:e.data[i-1],consumed_config:{consumed_config:e.consumed_config}},null,8,["class","highlight","input_data","consumed_config"]))),128))])):(n(),l("div",se,[I(b,{input_data:{data:e.data},consumed_config:{consumed_config:e.consumed_config}},null,8,["input_data","consumed_config"])]))])):e.consumed_config!=null&&e.consumed_config!=null&&(e.data==null||e.data==null)&&e.is_fetching==!1?(n(),l("main",ne,[I(te,z(O(e.$data)),null,16)])):(n(),l("main",oe,re))}});export{ge as default};
